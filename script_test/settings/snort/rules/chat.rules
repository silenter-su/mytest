reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Facebook Chat (send message)"; flow:established,to_server; content:"POST"; http_method; content:"/ajax/chat/send.php"; http_uri; content:"facebook.com"; http_header; reference:url,doc.emergingthreats.net/2010784; classtype:policy-violation; sid:2010784; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Facebook Chat (buddy list)"; flow:established,to_server; content:"POST"; http_method; content:"/ajax/chat/buddy_list.php"; http_uri; content:"facebook.com"; http_header; reference:url,doc.emergingthreats.net/2010785; classtype:policy-violation; sid:2010785; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Facebook Chat (settings)"; flow:established,to_server; content:"POST"; http_method; content:"/ajax/chat/settings.php"; http_uri; content:"facebook.com|0d 0a|"; http_header;  reference:url,doc.emergingthreats.net/2010786; classtype:policy-violation; sid:2010786; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Facebook Chat using XMPP"; flow:to_server,established; content:"chat.facebook.com"; nocase; content:"jabber|3A|client"; nocase; distance:9; within:13; detection_filter: track by_src, count 1, seconds 60; reference:url,www.facebook.com/sitetour/chat.php; reference:url,doc.emergingthreats.net/2010819; classtype:policy-violation; sid:2010819; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Gadu-Gadu IM Login Server Request"; flow:established,to_server; content:"/appsvc/appmsg"; http_uri; nocase; content:".asp"; http_uri; nocase; content:"fmnumber="; http_uri; content:"&version="; http_uri; content:"&fmt="; http_uri; content:"Host|3a| appmsg.gadu-gadu."; http_header; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008295; classtype:policy-violation; sid:2008295; rev:6;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat Server Welcome Packet"; flow:established,from_server; dsize:12; content:"|01 00 00 00|"; depth:4; flowbits:set,ET.gadu.welcome; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008297; classtype:policy-violation; sid:2008297; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat Client Login Packet"; flowbits:isset,ET.gadu.welcome; flow:established,to_server; dsize:<50; content:"|15 00 00 00|"; depth:4; flowbits:set,ET.gadu.loginsent; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008298; classtype:policy-violation; sid:2008298; rev:3;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat Server Login OK Packet"; flowbits:isset,ET.gadu.loginsent; flow:established,from_server; content:"|03 00 00 00|"; depth:4; byte_jump:4,0,relative,little,post_offset -1; isdataat:!2,relative; flowbits:set,ET.gadu.loggedin; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008299; classtype:policy-violation; sid:2008299; rev:4;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat Server Login Failed Packet"; flowbits:isset,ET.gadu.loginsent; flow:established,from_server; dsize:8; content:"|09 00 00 00 00 00 00 00|"; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008300; classtype:policy-violation; sid:2008300; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat Server Available Status Packet"; flowbits:isset,ET.gadu.loggedin; flow:established,to_server; content:"|02 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008301; classtype:policy-violation; sid:2008301; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat Send Message"; flowbits:isset,ET.gadu.loggedin; flow:established,to_server; content:"|0b 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008302; classtype:policy-violation; sid:2008302; rev:3;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat Receive Message"; flowbits:isset,ET.gadu.loggedin; flow:established,from_server; content:"|0a 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008303; classtype:policy-violation; sid:2008303; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat Keepalive PING"; flowbits:isset,ET.gadu.loggedin; flow:established,to_server; content:"|08 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008304; classtype:policy-violation; sid:2008304; rev:3;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat Keepalive PONG"; flowbits:isset,ET.gadu.loggedin; flow:established,from_server; content:"|07 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008305; classtype:policy-violation; sid:2008305; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat File Send Request"; flowbits:isset,ET.gadu.loggedin; flow:established,to_server; content:"|01 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008306; classtype:policy-violation; sid:2008306; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 8074 (msg:"CHAT GaduGadu Chat File Send Details"; flowbits:isset,ET.gadu.loggedin; flow:established,to_server; content:"|03 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008307; classtype:policy-violation; sid:2008307; rev:3;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat File Send Accept"; flowbits:isset,ET.gadu.loggedin; flow:established,from_server; content:"|06 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008308; classtype:policy-violation; sid:2008308; rev:3;)
reject tcp $EXTERNAL_NET 8074 -> $HOME_NET any (msg:"CHAT GaduGadu Chat File Send Begin"; flowbits:isset,ET.gadu.loggedin; flow:established,from_server; content:"|03 00 00 00|"; depth:4; reference:url,piotr.trzcionkowski.pl/default.asp?load=/programy/pppgg_protokol.html; reference:url,doc.emergingthreats.net/2008309; classtype:policy-violation; sid:2008309; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5190 (msg:"CHAT ICQ Status Invisible"; flow: from_client,established; content:"|2A02|"; depth: 2; content:"|001900130005|"; offset: 4; depth: 6; reference:url,doc.emergingthreats.net/2001801; classtype:policy-violation; sid:2001801; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5190 (msg:"CHAT ICQ Status Change (1)"; flow: from_client,established; content:"|2A02|"; depth: 2; content:"|000E00010011|"; offset: 4; depth: 6; reference:url,doc.emergingthreats.net/2001802; classtype:policy-violation; sid:2001802; rev:6;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5190 (msg:"CHAT ICQ Status Change (2)"; flow: from_client,established; content:"|2A02|"; depth: 2; content:"|00120001001E|"; offset: 4; depth: 6; reference:url,doc.emergingthreats.net/2001803; classtype:policy-violation; sid:2001803; rev:6;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5190 (msg:"CHAT ICQ Login"; flow: from_client,established; content:"|2A01|"; depth: 2; content:"|00010001|"; offset: 8; depth: 4; reference:url,doc.emergingthreats.net/2001804; classtype:policy-violation; sid:2001804; rev:5;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT ICQ Message"; flow: established; content:"|2A02|"; depth: 2; content:"|000400060000|"; offset: 6; depth: 6; reference:url,doc.emergingthreats.net/2001805; classtype:policy-violation; sid:2001805; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Google Talk (Jabber) Client Login"; flow:established,to_server; content:"gmail.com"; nocase; content:"jabber"; nocase; distance:9; within:6; reference:url,talk.google.com; reference:url,www.xmpp.org; reference:url,doc.emergingthreats.net/2002327; classtype:policy-violation; sid:2002327; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Google IM traffic Jabber client sign-on"; flow:to_server; content:"gmail.com"; nocase; content:"jabber.org"; nocase; content:"version="; reference:url,www.google.com/talk; reference:url,doc.emergingthreats.net/2002334; classtype:policy-violation; sid:2002334; rev:5;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT MSN file transfer request"; flow: established; content:"MSG "; depth: 4; content:"Content-Type|3A|"; nocase; distance: 0; content:"text/x-msmsgsinvite"; fast_pattern:only; content:"Application-Name|3A|"; content:"File Transfer"; nocase; distance: 0; reference:url,doc.emergingthreats.net/2001241; classtype:policy-violation; sid:2001241; rev:8;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT MSN file transfer accept"; flow: established; content:"MSG "; depth: 4; content:"Content-Type|3A|"; nocase; content:"text/x-msmsgsinvite"; fast_pattern:only; content:"Invitation-Command|3A|"; content:"ACCEPT"; distance: 1; reference:url,doc.emergingthreats.net/2001242; classtype:policy-violation; sid:2001242; rev:8;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT MSN file transfer reject"; flow: established; content:"MSG "; depth: 4; content:"Content-Type|3A|"; nocase; content:"text/x-msmsgsinvite"; fast_pattern:only; content:"Invitation-Command|3A|"; content:"CANCEL"; distance: 0; content:"Cancel-Code|3A|"; nocase; content:"REJECT"; nocase; distance: 0; reference:url,doc.emergingthreats.net/2001243; classtype:policy-violation; sid:2001243; rev:9;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT MSN IM Poll via HTTP"; flow: established,to_server; content:"/gateway/gateway.dll?Action=poll&SessionID="; http_uri; nocase; detection_filter: track by_src, count 10, seconds 3600; reference:url,doc.emergingthreats.net/2001682; classtype:policy-violation; sid:2001682; rev:9;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT MSN status change"; flow:established,to_server; content:"CHG "; depth:55; reference:url,doc.emergingthreats.net/2002192; classtype:policy-violation; sid:2002192; rev:4;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT General MSN Chat Activity"; flow: established; content:"Content-Type|3A|"; http_header; content:"application/x-msn-messenger"; http_header; reference:url,www.hypothetic.org/docs/msn/general/http_examples.php; reference:url,doc.emergingthreats.net/2009375; classtype:policy-violation; sid:2009375; rev:3;)
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"CHAT Yahoo IM voicechat"; flow: from_server,established; content:"YMSG"; nocase; depth: 4; content:"|00|J"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001254; classtype:policy-violation; sid:2001254; rev:7;)
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"CHAT Yahoo IM conference invitation"; flow: from_server,established; content:"YMSG"; nocase; depth: 4; content:"|00 18|"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001256; classtype:policy-violation; sid:2001256; rev:7;)
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"CHAT Yahoo IM conference logon success"; flow: from_server,established; content:"YMSG"; nocase; depth: 4; content:"|00 19|"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001257; classtype:policy-violation; sid:2001257; rev:7;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT Yahoo IM conference message"; flow: to_server,established; content:"YMSG"; nocase; depth: 4; content:"|00 1D|"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001258; classtype:policy-violation; sid:2001258; rev:7;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT Yahoo IM Unavailable Status"; flow: to_server,established; content:"|59 47 00 0b 00 00 00 00 00 12 00 00 00 00|"; fast_pattern:only; reference:url,doc.emergingthreats.net/2001427; classtype:policy-violation; sid:2001427; rev:6;)
reject tcp $HOME_NET any <> $EXTERNAL_NET any (msg:"CHAT Yahoo IM file transfer request"; flow: established; content:"YMSG"; nocase; depth: 4; content:"|00 dc|"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001259; classtype:policy-violation; sid:2001259; rev:9;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT Yahoo IM conference offer invitation"; flow: to_server,established; content:"YMSG"; nocase; depth: 4; content:"|00|P"; offset: 10; depth: 2; reference:url,doc.emergingthreats.net/2001262; classtype:policy-violation; sid:2001262; rev:7;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT Yahoo IM conference request"; flow: to_server,established; content:"<R"; depth: 2; pcre:"/^\x3c(REQIMG|RVWCFG)\x3e/ism"; reference:url,doc.emergingthreats.net/2001263; classtype:policy-violation; sid:2001263; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Yahoo IM Client Install"; flow: to_server,established; content:"/ycontent/stats.php?version="; nocase; http_uri; content:"EVENT=InstallBegin"; nocase; http_uri; reference:url,doc.emergingthreats.net/2002659; classtype:policy-violation; sid:2002659; rev:5;)
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"CHAT IRC authorization message"; flow: established; content:"NOTICE AUTH"; content:"Looking up your hostname..."; nocase; reference:url,doc.emergingthreats.net/2000355; classtype:misc-activity; sid:2000355; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Skype VOIP Checking Version (Startup)"; flow: to_server,established; content:"/ui/"; http_uri; nocase; content:"/getlatestversion?ver="; http_uri; nocase; reference:url,www1.cs.columbia.edu/~library/TR-repository/reports/reports-2004/cucs-039-04.pdf; reference:url,doc.emergingthreats.net/2001595; classtype:policy-violation; sid:2001595; rev:10;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Skype User-Agent detected"; flow:to_server,established; content:"Skype"; http_header;  pcre:"/User-Agent\x3a[^\n\r]+Skype/Hi"; reference:url,doc.emergingthreats.net/2002157; classtype:policy-violation; sid:2002157; rev:10;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Gadu-Gadu Chat Client Checkin via HTTP"; flow:established,to_server; content:"/appsvc/appmsg"; nocase; http_uri; content:"fmnumber="; nocase; http_uri; content:"&version="; nocase; http_uri; content:"&fmt="; nocase; http_uri; content:"&lastmsg="; http_uri; nocase; reference:url,doc.emergingthreats.net/2007866; classtype:trojan-activity; sid:2007866; rev:7;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC USER command"; flow:to_server,established; content:"USER|20|"; nocase; depth:5; content:"|203a|"; within:40; content:"|0a|"; within:40; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002023; classtype:misc-activity; sid:2002023; rev:15;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC NICK command"; flow:to_server,established; content:"NICK|20|"; nocase; depth:5; content:"|0a|"; within:40; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002024; classtype:misc-activity; sid:2002024; rev:18;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC JOIN command"; flow:to_server,established; content:"JOIN|2023|"; nocase; depth:50; content:"|0a|"; within:40; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002025; classtype:misc-activity; sid:2002025; rev:18;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC PRIVMSG command"; flow:established,to_server; content:"PRIVMSG|20|"; depth:8; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002026; classtype:misc-activity; sid:2002026; rev:20;)
reject tcp any 6666:7000 -> any any (msg:"CHAT IRC PING command"; flow:from_server,established; content:"PING|20|"; depth:5; flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002027; classtype:misc-activity; sid:2002027; rev:15;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC PONG response"; flow:from_client,established; content:"PONG|20|"; depth:5;  flowbits:set,is_proto_irc; reference:url,doc.emergingthreats.net/2002028; classtype:misc-activity; sid:2002028; rev:18;)
reject tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"CHAT Cerulean Studios Trillian Image Filename XML Tag Stack Buffer Overflow"; flow:from_server,established; content:"|2a 02|"; depth:2; content:"|00 04 00 07|"; distance:4; within:4; content:"|00 02|"; distance:0; byte_test:2,>,1024,0,relative; content:"<IMG"; distance:2; nocase; pcre:"/^[^>]*SRC(\s*=\s*(\x22[^\x22]{1024}|\x27[^\x27]{1024})|=[^\x20\x09]{1024})/Ri"; reference:cve,CVE-2008-5401; reference:bugtraq,32645; reference:secunia,33001; classtype:attempted-user; sid:2800396; rev:2;)
reject tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"CHAT Cerulean Studios Trillian AIM XML Tag Handling Heap Buffer Overflow"; flow:from_server,established; content:"|2a 02|"; depth:2; content:"|00 04 00 07|"; distance:4; within:4; content:"|00 02|"; distance:0; byte_test:2,>,1024,0,relative; content:"|3c 3e|"; distance:2; isdataat:1023,relative; reference:cve,CVE-2008-5403; reference:bugtraq,32645; reference:secunia,33001; classtype:attempted-user; sid:2800397; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Login"; flow:to_server,established; content:"|02 00 c8|"; depth:3; content:"|00 09 00 00 00 04 00 00 00 01 00 08|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803219; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Login Challenge Response"; flow:to_server,established; content:"|02 00 CA|"; depth:3; content:"|00 01 00 00 00 04|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803220; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Register"; flow:to_server,established; content:"|02 00 64|"; depth:3; content:"|00 04|"; distance:0; content:"|00 03|"; distance:0; content:"|00 02|"; distance:0; content:"|00 01 00 00 00 01 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803221; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Get Contact List"; flow:to_server,established; content:"|02 00 01 90 00 03|"; depth:6; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803222; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Send Message"; flow:to_server,established; content:"|02 00 f4|"; depth:3; content:"|00 08|"; distance:0; content:"|00 06 00 00 00 02 00 01 00 04|"; distance:0; content:"|00 03 00 00 00 01 03 00 02|"; distance:0; content:"|00 01 00 00 00 01 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803223; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"CHAT mig33 Client Keep Alive"; flow:to_server,established; dsize:<10; content:"|02 00 02|"; depth:3; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803224; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Login Challenge"; flow:from_server,established; content:"|02 00 c9|"; depth:3; content:"|00 02|"; distance:0; content:"|00 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803225; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Keep Alive"; flow:from_server,established; dsize:<10; content:"|02 00 03|"; depth:3; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803226; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Login Fail"; flow:from_server,established; content:"|02 00 00 00 02|"; depth:5; content:"|00 02|"; distance:0; content:"|00 01 00 00 00 02 00 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803227; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Registered OK"; flow:from_server,established; content:"|02 00 01 00 02|"; depth:5; content:"|00 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803228; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Login Success"; flow:from_server,established; content:"|02 00 cb 00 0c|"; depth:5; content:"|00 0C|"; distance:0; content:"|00 0B|"; distance:0; content:"|00 0A|"; distance:0; content:"|00 09 00 00 00 04 00 00 00 03 00 08 00 00 00 01 00 00 06 00 00 00 01 00 00 03|"; distance:0; content:"|00 02 00 00 00 01 00 00 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803229; rev:2;)
reject tcp $EXTERNAL_NET 9119 -> $HOME_NET any (msg:"CHAT mig33 Server Receive Message"; flow:from_server,established; content:"|02 01 f4|"; depth:3; content:"|00 08|"; distance:0; content:"|00 06 00 00 00 02 00 01 00 04|"; distance:0; content:"|00 03 00 00 00 01|"; distance:0; content:"|00 02|"; distance:0; content:"|00 01 00 00 00 01 01|"; distance:0; reference:url,www.devinsmith.net/articles/mig33/mig33.html; classtype:policy-violation; sid:2803230; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Windows Live Messenger User-Agent"; flow:established,to_server; content:"User|2d|Agent|3a 20|"; http_header; content:"Windows|20|Live|20|Messenger|20|"; within:150; http_header; classtype:policy-violation; sid:2803262; rev:2;)
reject tcp any any -> any 6666:7000 (msg:"CHAT IRC USER Likely bot with 0 0 colon checkin"; flow:to_server,established; content:"USER|20|"; nocase; content:" 0 0 |3a|"; within:40; content:"|0a|"; within:40; flowbits:set,is_proto_irc; classtype:misc-activity; sid:2806660; rev:1;)
reject tcp any any -> any !6666:7000 (msg:"CHAT IRC USER Off-port Likely bot with 0 0 colon checkin"; flow:to_server,established; content:"USER|20|"; nocase; content:" 0 0 |3a|"; within:40; content:"|0a|"; within:40; flowbits:set,is_proto_irc; classtype:misc-activity; sid:2806661; rev:1;)
reject tcp $AIM_SERVERS any -> $HOME_NET any (msg:"CHAT AIM receive message"; flow:to_client; content:"*|02|"; depth:2; content:"|00 04 00 07|"; depth:4; offset:6; classtype:policy-violation; sid:2101633; rev:7;)
reject tcp $EXTERNAL_NET 1863 -> $HOME_NET any (msg:"CHAT MSN outbound file transfer accept"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; distance:0; nocase; content:"MSNSLP/1.0 200 OK"; distance:0; nocase; classtype:policy-violation; sid:2101988; rev:6;)
reject tcp $EXTERNAL_NET 1863 -> $HOME_NET any (msg:"CHAT MSN outbound file transfer rejected"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; distance:0; nocase; content:"MSNSLP/1.0 603 Decline"; distance:0; nocase; classtype:policy-violation; sid:2101989; rev:7;)
reject tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM conference invitation"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 18|"; depth:2; offset:10; classtype:policy-violation; sid:2102453; rev:4;)
reject tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM conference logon success"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 19|"; depth:2; offset:10; classtype:policy-violation; sid:2102454; rev:4;)
reject tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM successful chat join"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00 98|"; depth:2; offset:10; classtype:policy-violation; sid:2102458; rev:5;)
reject tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo IM voicechat"; flow:from_server,established; content:"YMSG"; depth:4; nocase; content:"|00|J"; depth:2; offset:10; classtype:policy-violation; sid:2102451; rev:4;)
reject tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"CHAT Yahoo Messenger File Transfer Receive Request"; flow:established; content:"YMSG"; depth:4; content:"|00|M"; depth:2; offset:10; classtype:policy-violation; sid:2102456; rev:5;)
reject tcp $EXTERNAL_NET 5100 -> $HOME_NET any (msg:"CHAT Yahoo IM conference watch"; flow:from_server,established; content:"|0D 00 05 00|"; depth:4; classtype:policy-violation; sid:2102461; rev:5;)
reject tcp $EXTERNAL_NET 5222 -> $HOME_NET any (msg:"CHAT Jabber/Google Talk Incoming Message"; flow:to_client,established; content:"<message"; nocase; reference:url,www.google.com/talk/; classtype:policy-violation; sid:2100236; rev:3;)
reject tcp $EXTERNAL_NET 5222 -> $HOME_NET any (msg:"CHAT Jabber/Google Talk Logon Success"; flow:to_client,established; content:"<success"; nocase; reference:url,www.google.com/talk/; classtype:policy-violation; sid:2100235; rev:3;)
reject tcp $HOME_NET any -> $AIM_SERVERS any (msg:"CHAT AIM login"; flow:to_server,established; content:"*|02|"; depth:2; content:"|00 17 00 06|"; within:8; distance:4; classtype:policy-violation; sid:2101631; rev:9;)
reject tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"CHAT Google Talk Version Check"; flow: established,to_server; content:"/googletalk/google-talk-versioncheck.txt?"; http_uri; nocase; classtype:policy-violation; sid:2100876; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN login attempt"; flow:to_server,established; content:"USR "; depth:4; nocase; content:" TWN "; distance:1; nocase; detection_filter: track by_src, count 1, seconds 60; classtype:policy-violation; sid:2101991; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN outbound file transfer request"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A| application/x-msnmsgrp2p"; nocase; content:"INVITE"; distance:0; nocase; classtype:policy-violation; sid:2101986; rev:7;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 1863 (msg:"CHAT MSN user search"; flow:to_server,established; content:"CAL "; depth:4; nocase; classtype:policy-violation; sid:2101990; rev:2;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM conference message"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00 1D|"; depth:2; offset:10; classtype:policy-violation; sid:2102455; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM conference offer invitation"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00|P"; depth:2; offset:10; classtype:policy-violation; sid:2102459; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"CHAT Yahoo IM ping"; flow:to_server,established; content:"YMSG"; depth:4; nocase; content:"|00 12|"; depth:2; offset:10; classtype:policy-violation; sid:2102452; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5100 (msg:"CHAT Yahoo IM conference request"; flow:to_server,established; content:"<R"; depth:2; pcre:"/^\x3c(REQIMG|RVWCFG)\x3e/ism"; classtype:policy-violation; sid:2102460; rev:5;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Google Talk Logon"; flow:to_server,established; content:"<stream|3a|stream to=\"gmail.com\""; nocase; reference:url,www.google.com/talk/; classtype:policy-violation; sid:2100232; rev:4;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Google Talk Startup"; flow: established,to_server; content:"google.com"; nocase; content:"jabber|3A|client"; nocase; detection_filter: track by_src, count 1, seconds 300; classtype:policy-violation; sid:2100877; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Jabber/Google Talk Outgoing Traffic"; flow:to_server,established; content:"<stream"; nocase; reference:url,www.google.com/talk/; classtype:not-suspicious; sid:2100230; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 5222 (msg:"CHAT Jabber/Google Talk Outoing Message"; flow:to_server,established; content:"<message"; nocase; reference:url,www.google.com/talk/; classtype:policy-violation; sid:2100233; rev:3;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC DCC chat request"; flow:to_server,established; content:"PRIVMSG "; depth:8; nocase; content:" |3A|.DCC CHAT chat"; nocase; flowbits:set,is_proto_irc; classtype:policy-violation; sid:2101640; rev:10;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC DCC file transfer request"; flow:to_server,established; content:"PRIVMSG "; depth:8; nocase; content:" |3A|.DCC SEND"; nocase; flowbits:set,is_proto_irc; classtype:policy-violation; sid:2101639; rev:11;)
reject tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 (msg:"CHAT IRC Channel join"; flow:to_server,established; content:"JOIN |3A| |23|"; fast_pattern:only; nocase; flowbits:set,is_proto_irc; classtype:policy-violation; sid:2101729; rev:10;)
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"CHAT ICQ access"; flow:to_server,established; content:"User-Agent|3A|ICQ"; classtype:policy-violation; sid:2100541; rev:12;)
reject tcp $HOME_NET any <> $EXTERNAL_NET 1863 (msg:"CHAT MSN message"; flow:established; content:"MSG "; depth:4; content:"Content-Type|3A|"; nocase; content:"text/plain"; distance:1; classtype:policy-violation; sid:2100540; rev:12;)
